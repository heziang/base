<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="cloud.base.dao.SysRoleMapper">
	<resultMap id="SysRoleMap" type="cloud.base.model.SysRole">
		<id column="roleId" property="roleId" jdbcType="VARCHAR" />
		<result column="groupcode" property="groupcode" jdbcType="VARCHAR" />
		<result column="roleName" property="roleName" jdbcType="VARCHAR" />
		<result column="roleorder" property="roleorder" jdbcType="INTEGER" />
	</resultMap>
	<insert id="save" keyProperty="roleId" parameterType="cloud.base.model.SysRole" >
		<selectKey keyProperty="roleId" resultType="String" order="BEFORE">
	        select  replace(uuid(),'-','')   from dual
	    </selectKey> 
	    insert into sys_role 
	    	(roleId, groupcode, roleName,roleorder) 
	    values 
	    	(
		    	#{roleId,jdbcType=VARCHAR},#{groupcode,jdbcType=VARCHAR},
		    	#{roleName,jdbcType=VARCHAR},#{roleorder,jdbcType=INT}
	    	);
  	</insert>
  	<update id="update" parameterType="cloud.base.model.SysRole">
	        update sys_role t
	        <set>
	            <if test="groupcode != null and groupcode !=''">
	            	groupcode=#{groupcode},
	            </if>
	            <if test="roleName != null and roleName !=''">
	            	roleName=#{roleName},
	            </if>
	            <if test="roleorder != null and roleorder !=''">
	            	roleorder=#{roleorder}
	            </if>
	        </set>
	        where t.roleId = #{roleId,jdbcType=VARCHAR}
	</update>
	<delete id="delete" parameterType="String">  
        delete from sys_role where roleId in 
        <foreach item="id" collection="array" open="(" separator="," close=")">
            #{id}
        </foreach>
	</delete>  
	<select id="search" resultMap="SysRoleMap" parameterType="Map">
		select
		t.*
		from sys_role t 
		where 1=1
		<if test="roleName !=null and roleName !='' ">  
           and t.roleName like concat(concat('%', #{roleName}),'%')   
        </if>
		<if test="groupcode!=null and groupcode!='' ">  
           and t.groupcode =  #{groupcode}
        </if>
        <if test="start!=null and rows!=null">
        	limit #{start}, #{rows}
        </if>
	</select>
	
	<select id="getTotal" resultType="String" parameterType="Map">
		select
		t.*
		from sys_role t 
		where 1=1
		<if test="roleName !=null and roleName !='' ">  
           and t.roleName like concat(concat('%', #{roleName}),'%')   
        </if>
		<if test="groupcode!=null and groupcode!='' ">  
           and t.groupcode =  #{groupcode}
        </if>
	</select>
	
	<select id="getSysRoleById" resultMap="SysRoleMap" parameterType="java.lang.String">
		select
		t.*
		from sys_role t 
		where t.roleId = #{roleId,jdbcType=VARCHAR}
	</select>
</mapper>